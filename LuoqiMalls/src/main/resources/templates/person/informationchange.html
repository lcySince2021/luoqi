<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=0">

		<title>个人资料</title>

		<link th:href="@{/AmazeUI-2.4.2/assets/css/admin.css}" rel="stylesheet" type="text/css">
		<link th:href="@{/assets/css/amazeui.css}" rel="stylesheet" type="text/css">
		<link rel="stylesheet" th:href="@{/layui/css/layui.css}"  media="all">
		<link th:href="@{/css/personal.css}" rel="stylesheet" type="text/css">
		<link th:href="@{/css/infstyle.css}" rel="stylesheet" type="text/css">
		<script th:src="@{/assets/js/jquery.min.js}" type="text/javascript"></script>
		<script th:src="@{/assets/js/amazeui.js}" type="text/javascript"></script>
		<script src="http://libs.baidu.com/jquery/2.1.1/jquery.min.js"></script>
		<script type="text/javascript" th:src="@{/js/jquery.js}"></script>

	</head>
	<script th:src="@{/layui/layui.js}" charset="utf-8"></script>


	<body>
	<iframe th:src="@{/goods/heart}" width="1920px" height="45px"  style="border: none"></iframe>
	<!--悬浮搜索框-->
	<br/>
	<div class="hmtop">
		<iframe th:src="@{/goods/heart1}" width="1960px" height="120px"  style="border: none"></iframe><!--->


		<div class="clear"></div>
	</div>

		<div style=" margin-left: 100px;width: 1800px; height: 30px; border: none;background-color:silver">  </div>

		<b class="line"></b>
		<div class="center">
			<div class="col-main">
				<div class="main-wrap">

					<div class="user-info">
						<!--标题 -->
						<div class="am-cf am-padding">
							<div class="am-fl am-cf"><strong class="am-text-danger am-text-lg">个人资料</strong> / <small>Personal&nbsp;information</small></div>
						</div>
						<hr/>

						<!--头像 -->
						<div class="user-infoPic">

							<div class="filePic">
								<!--<input type="file" class="inputPic" allowexts="gif,jpeg,jpg,png,bmp" accept="image/*">-->
								<!--<img class="am-circle am-img-thumbnail" th:src="@{/images/getAvatar.do.jpg}" alt="" />-->

							</div>

							<p class="am-form-help">头像</p>

							<div class="info-m">
								<div><b>用户名：<strong th:text="${user.userNick}"></strong></b></div>
								<div class="u-level">
									<span class="rank r2">
							             <s class="vip1"></s>
										<div th:if="${session.user.userVip == 1}"  >
										<a class="classes" href="#">普通会员</a></div>
										<div th:unless="${session.user.userVip == 1}"  >
										<a class="classes" href="#">vip会员</a></div>
						            </span>
								</div>
							</div>
						</div>

						<!--个人信息 -->
						<div class="info-main">
							<form class="am-form am-form-horizontal" th:action="@{/user/information}" method="post">
								<input type="hidden" th:value="${upToken}"  class="upToken"/>
								<input type="hidden" th:value="${upToken}"  class="upTokenss"/>
								<div class="row cl">
									<label class="form-label col-xs-4 col-sm-2">头像：</label>
									<div class="formControls col-xs-8 col-sm-9">
										<p><img src="" width="100px" height="80px" id="imgs"/>

											<input type="file" name="userheart" id="userheart"/>
									</div>
								</div>

								<div class="am-form-group">
									<label for="user-name2" class="am-form-label">昵称</label>
									<div class="am-form-content">
										<input type="text" id="user-name2" placeholder="nickname" name="userNick" >

									</div>
								</div>

								<div class="am-form-group">
									<label for="user-name" class="am-form-label">姓名</label>
									<div class="am-form-content">
										<input type="text" id="user-name2" placeholder="name" name="userName">

									</div>
								</div>

								<div class="am-form-group">
									<label class="am-form-label">性别</label>
									<div class="am-form-content sex">
										<label class="am-radio-inline">
											<input type="radio" name="userSex" value="男" data-am-ucheck> 男
										</label>
										<label class="am-radio-inline">
											<input type="radio" name="userSex" value="女" data-am-ucheck> 女
										</label>
										<label class="am-radio-inline">
											<input type="radio" name="userSex" value="保密" data-am-ucheck> 保密
										</label>
									</div>
								</div>

								<div class="am-form-group">
									<label for="user-birth" class="am-form-label">生日</label>
									<div class="layui-inline"  style="margin-left: 1px">
										&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
										<div class="layui-input-inline">
											<input type="text" class="layui-input" id="test1-1" placeholder="yyyy-MM-dd" name="userBir">
										</div>
									</div>
							
								</div>
								<div class="am-form-group">
									<label for="user-phone" class="am-form-label">电话</label>
									<div class="am-form-content">
										<input id="user-phone" placeholder="telephonenumber" type="tel" name="userTel">

									</div>
								</div>
								<div class="am-form-group">
									<label for="user-email" class="am-form-label">电子邮件</label>
									<div class="am-form-content">
										<input id="user-email" placeholder="Email" type="email" name="userEmall">

									</div>
								</div>
								<div class="am-form-group address">
									<label for="user-address" class="am-form-label">收货地址</label>
									<div class="am-form-content address">
										<a href="address.html">
											<p class="new-mu_l2cw">
												<span class="province">湖北</span>省
												<span class="city">武汉</span>市
												<span class="dist">洪山</span>区
												<span class="street">雄楚大道666号(中南财经政法大学)</span>
												<span class="am-icon-angle-right"></span>
											</p>
										</a>

									</div>
								</div>
								<div class="am-form-group safety">
									<label for="user-safety" class="am-form-label">账号安全</label>
									<div class="am-form-content safety">
										<a href="safety.html">

											<span class="am-icon-angle-right"></span>

										</a>

									</div>
								</div>

								<div class="info-btn">
									<input type="submit" class="am-btn am-btn-danger" value="保存修改"/>
								</div>

							</form>
						</div>

					</div>

				</div>
				<!--底部-->
				<!--<div class="footer">-->
					<!--<div class="footer-hd">-->
						<!--<p>-->

							<!--<a href="../home/home.html">商城首页</a>-->

						<!--</p>-->
					<!--</div>-->
				<!--</div>-->
			</div>

			<aside class="menu">
				<ul>
					<li class="person">
						<a href="index.html">个人中心</a>
					</li>
					<li class="person">
						<a href="#">个人资料</a>
						<ul>
							<li class="active"> <a href="information.html">个人信息</a></li>
							<li> <a th:href="@{/pwd}">安全设置</a></li>
							<li> <a th:href="@{/address/address(userAccount=${session.user.userAccount})}">收货地址</a></li>
						</ul>
					</li>
					<li class="person">
						<a href="#">我的交易</a>
						<ul>
							<li><a th:href="@{/order/order}">订单管理</a></li>
							<li> <a th:href="@{/returnGoods/returngoods}">退款售后</a></li>
						</ul>
					</li>
					<li class="person">
						<a href="#">我的资产</a>
						<ul>
							<li> <a th:href="@{/volume/personselectvolume}">优惠券 </a></li>
							<!--<li> <a href="bonus.html">红包</a></li>-->
							<li> <a th:href="@{/bill/billlist}">账单明细</a></li>
						</ul>
					</li>

					<li class="person">
						<a href="#">我的小窝</a>
						<ul>
							<li> <a th:href="@{/collect/collectsearch(userId=${session.user.userId})}">收藏</a></li>
							<li> <a th:href="@{/foot/getfoot(userId=${session.user.userId})}">足迹</a></li>
							<li> <a th:href="@{/pingjia/comment(userId=${session.user.userId})}">评价</a></li>

							<!--<li> <a href="news.html">消息</a></li>-->
						</ul>
					</li>

				</ul>

			</aside>
		</div>

	</body>
	<script type="text/javascript" src="https://unpkg.com/qiniu-js@2.5.3/dist/qiniu.min.js"></script>
	<script>
        $('#userheart').on('change',function (e) {
            var token=$(this).closest("form").find(".upToken").val();

            fileid=$(this).attr('id')
            console.log(fileid)
            file = e.target.files[0]
            var key;
            console.log(file)
            var config = {
                region: qiniu.region.z0
            };
            var putExtra = {
                params: {'index':$(this).attr('id')},
                mimeType: ["image/png", "image/jpeg", "image/gif"] || null
            };
            var observer = {
                next(res){
                    // ...
                },
                error(err){
                    console.log(err)
                },
                complete(res) {
                    console.log(res)
                    key = res['key']
                    console.log(key)

                    $.ajax({
                        //请求的方式,向服务器发送请求,查询用户名是否存在,发送什么类型的请求
                        type: "POST",
                        //MVC ,请求发送C层,C->Model,去域对象的里面取,js可以是被el表达式
                        url: "/Luoqi/user/userheart?key="+key,
                        success: function (maps) {

                            var ww=maps.imgid;
                            $('#picid').value(ww);
                        },
                        error: function () {
                            alert(0)
                            layer.closeAll();
                        }
                    });
                }
            }
//        $("#filearray").val(JSON.stringify(filearray));

            var observable = qiniu.upload(file, key, token, putExtra, config);
            var subscription = observable.subscribe(observer);
        });


	</script>



</html>